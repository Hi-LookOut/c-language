# splitFile 

## 是一个关于在window下使用fopen/fgets分割文件的demo。
#### 下面记录在写的过程中遇到了分割文件乱码的坑和解决的方法。
---

### 乱码发生可能的原因
   - 文件存储的格式
   - 文件分割后，发现第一个文件最后一个字符乱码，后面文件大部分乱码。
   - fgets函数的减1问题，导致前面一些文字不乱码，后面的乱码。
   
### 解决方法
   
1. 格式问题:
      检查自己读写格式是否与存储的文件格式一样，默认用ANSI.
2. 最后一个字符乱码问题
   这个要考虑临界点。由于一个char占的2个字节，却被分给了两个文件，于是导致第一个文件最后一个字符出问题，并影响了后面的文件。

3. fgets问题
      先看其实现：
      char *fgets(char *s, int n,  FILE *stream)
      {
          register int c;
          register char *cs;
          cs = s;

          while(--n > 0 && (c = getc(stream)) != EOF)
          {
              if((*cs++ =   c) == '\n')
              {
                 break;
              }
          }

         *cs = '\0';
         return (c == EOF && cs == s) ? NULL : s ;
      }

    我们注意看23行 --n>0
    n代表读取字节的个数，这样就导致我们循环只循环了n-1次，说明我们只取了n-1个字节。
    举个例子：
    我们要读取一个文件中（我爱你）三个文字，那么n=6，如果用fgets最终只读取了5个字节，从而导致（你）显示为乱码。
    解决方法当然是传入n+1。
    
    但是我们可以看到其内部实现使用的fgetc，那么为啥我们不用这个代替fgetc了。
